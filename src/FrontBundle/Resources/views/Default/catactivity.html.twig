{% extends 'FrontBundle::layout.html.twig' %}

{% block wrapper %}
    <section id="boutique2ndnav" class="padding-top-25 no-padding-bottom border-bottom-1 border-grey-300" style="padding-top: 25px !important;background-color: #E0E2E0;height:60px">
        <div class="container">
            <div class="headline" style="margin-top: -16px">
                <h4>Recent Games</h4>
                <div class="btn-group pull-right">
                    <a href="#" class="btn btn-default"><i class="fa fa-th-large no-margin"></i></a>
                    <a href="#" class="btn btn-default"><i class="fa fa-bars no-margin"></i></a>
                </div>
                <div class="recherche" style="padding-right:30%;">
                    <input type="text" class="form-control hidden-xs" placeholder="Search Game...">

                    <div class="dropdown" style="margin-right:10%;" > 
                        <a href="#" class="btn btn-default btn-icon-left btn-icon-right dropdown-toggle" data-toggle="dropdown"><i class="fa fa-sort-amount-desc"></i> Sort by <i class="fa fa-caret-down"></i></a>
                        <ul class="dropdown-menu">
                            <li><a href="#">Date</a></li>
                            <li><a href="#">Score</a></li>
                            <li><a href="#">A-Z</a></li>
                        </ul>
                    </div>
                </div>

            </div>
        </div>
    </section>
    {% if is_granted('ROLE_ADMIN')%}
        <div class="text-center">
            <a href="javascript:void(0);" data-toggle="modal" data-target="#addact" class="button pill big primary">
                <span class="plus icon"></span>Ajouter une activité
            </a> 
        </div>
    {%endif%}
    <section class="bg-grey-50" style="padding-top: 0px">
        <div class="container">
            <div class="row">

                {%for act in activites%}
                    {%if not (act.getStatus() == "Desactiver" or act.getStatus() == "Deleted" ) %}
                        <div class="col-lg-4 col-md-4 col-sm-6 col-xs-12">
                            <div class="card">
                                <div class="card-img">
                                    <a href="{{path('actsingle',{'id':act.getId()})}}"><img src="{{asset(act.getImg())}}" alt=""></a>
                                    {% if is_granted('ROLE_ADMIN')%}<div class="category"><span class="label label-success">{{act.getStatus()}}</span></div>{%endif%}
                                    <div class="meta"><a href="{{path('actsingle',{'id':act.getId()})}}"><i class="fa fa-sign-in"></i> <span>15</span></a></div>
                                </div>
                                <div class="caption">
                                    <div class="text-center"><h3 class="card-title"><a href="{{path('actsingle',{'id':act.getId()})}}">{{act.getNom()}}</a></h3></div>
                                    <ul><li>{{act.getDescription()}}</li></ul>
                                            {% if is_granted('ROLE_ADMIN')%}
                                        <div class="text-center">
                                            {%if act.getActivation() == 0%}<a href="javascript:void(0);" class="left positive pill button" style="" onclick="ValidationActivity({{act.getId()}});"><span class="unlock icon"></span>Activer</a>{%else%}<a href="javascript:void(0);" class="left negative pill button" style="" onclick="ValidationActivity({{act.getId()}});"><span class="lock icon"></span>Desactiver</a>{%endif%} 
                                            <a href="javascript:void(0);" class="middle pill button" onclick="editModalAct({{act.getId()}});"><span class="pen icon"></span>Modifier</a>
                                            <a href="javascript:void(0);" class="right negative pill button" onclick="DeleteActivity({{act.getId()}});"><span class="cross icon"></span>Supprimer</a> 
                                        </div>
                                    {% else %}
                                        <div class="text-center">
                                            <a href="{{path('actsingle',{'id':act.getId()})}}" class="button pill big primary">
                                                <span class="fa fa-play"></span> Commencer
                                            </a> 
                                        </div>
                                    {%endif%}
                                </div>
                            </div>
                        </div>
                        <h3></h3>
                    {% endif %}
                {% endfor %}
            </div>
            <ul class="pagination margin-top-20" style="    margin-left: 25%;">
                <li class="disabled"><a href="#">Previous</a></li>
                <li class="disabled"><a href="#">1</a></li>
                <li><a href="#">2</a></li>
                <li><a href="#">3</a></li>
                <li><a href="#">4</a></li>
                <li><a href="#">5</a></li>
                <li><a href="#">6</a></li>
                <li><a href="#">7</a></li>
                <li><a href="#">8</a></li>
                <li><a href="#">...</a></li>
                <li><a href="#">124</a></li>
                <li><a href="#">125</a></li>
                <li><a href="#">Next</a></li>
            </ul>
        </div>
    </section>
    {% if is_granted('ROLE_ADMIN')%}
        <div class="text-center">
            <a href="#" data-toggle="modal" data-target="#addact" class="button pill big primary">
                <span class="plus icon"></span>Ajouter une activité
            </a>
        </div>
    {%endif%}

    <!-- ---------------------- Modals ---------------------------------------------->
    <div class="container modal fade" id="addact" tabindex="-1" role="dialog" aria-labelledby="addactLabel" >
        <div class="card card-container" style="max-width:60%">

            <form >
                <fieldset>
                    <legend>Ajouter une Activité</legend>
                    <div class="form-group">
                        <label class="col-md-4 control-label" >Nom<span style="color:red;margin-left:5px;font-weight: 900">*</span></label>
                        <div class="col-md-6  inputGroupContainer">
                            <div class="input-group"> <span class="input-group-addon"><i class="glyphicon glyphicon-bookmark"></i></span>
                                <input value="" name="NomAct" placeholder="Exemple : Flappy bird" id="NomAct" class="form-control"  type="text">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-4 control-label" >Description<span style="color:red;margin-left:5px;font-weight: 900">*</span></label>
                        <div class="col-md-6  inputGroupContainer">
                            <div class="input-group"> <span class="input-group-addon"><i class="glyphicon glyphicon-text-background"></i></span>
                                <textarea name="DescriptionAct" placeholder="faut mettre le principe du jeu içi" id="DescriptionAct" class="form-control"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-4 control-label" >Image<span style="color:red;margin-left:5px;font-weight: 900">*</span></label>
                        <div class="col-md-6  inputGroupContainer">
                            <div class="input-group"> <span class="input-group-addon"><i class="glyphicon glyphicon-camera"></i></span>
                                <input type='file' name="ImageAct" placeholder="Deposer l'image içi" id="ImageAct" class="form-control"/>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-4 control-label">Activer ?</label>
                        <div class="col-md-6  inputGroupContainer">
                            <div class="rdio rdio-theme circle col-md-3" style="transform: scale(0.9);margin-left: 1%;">
                                <input id="radio-type-circle1" type="radio"  name="activationAct" value="1" checked>
                                <label for="radio-type-circle1">Oui</label>
                            </div>
                            <div style="transform: scale(0.9);" class="rdio rdio-theme circle col-md-3">
                                <input id="radio-type-circle2" type="radio" name="activationAct" value="0">
                                <label for="radio-type-circle2">Non</label>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-4 control-label" >Date Début<span style="color:red;margin-left:5px;font-weight: 900">*</span></label>
                        <div class="col-md-6  inputGroupContainer">
                            <div class="input-group"> <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
                                <input value="{{ "now"|date("d/m/Y") }}" data-mask="39/19/2999" name="DateDebutAct" placeholder="Date début activité" id="DateDebutAct" class="form-control datepicker"  type="text">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-4 control-label" >Date Fin<span style="color:red;margin-left:5px;font-weight: 900">*</span></label>
                        <div class="col-md-6  inputGroupContainer">
                            <div class="input-group"> <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
                                <input value="{{ "now"|date_modify("+7 day")|date("d/m/Y") }}" data-mask="39/19/2999" name="DateFinAct" placeholder="Date Fin activité" id="DateFinAct" class="form-control datepicker"  type="text">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-4 control-label" >Coins<span style="color:red;margin-left:5px;font-weight: 900">*</span></label>
                        <div class="col-md-6  inputGroupContainer">
                            <div class="input-group"> <span class="input-group-addon"><i class="glyphicon glyphicon-bitcoin"></i></span>
                                <input value="" name="NbrPointAct" placeholder="Nombre Point Totale a Gagnée" id="NbrPointAct" class="form-control"  type="text">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-4 control-label" >Experience<span style="color:red;margin-left:5px;font-weight: 900">*</span></label>
                        <div class="col-md-6  inputGroupContainer">
                            <div class="input-group"> <span class="input-group-addon"><i class="glyphicon glyphicon-level-up"></i></span>
                                <input value="" name="ExpAct" placeholder="Experience a Gagnée" id="ExpAct" class="form-control"  type="text">
                            </div>
                        </div>
                    </div>
                </fieldset>
                <input id="AddCategorie" type="button" value="ajouter une activité" onclick="AjouterActivity();"/>
            </form>
        </div><!-- /card-container -->
    </div><!-- /container -->

    <!-- ------------------------------------------------------------------------------ -->

    <div class="container modal fade" id="editact" tabindex="-1" role="dialog" aria-labelledby="addactLabel" >
        <div class="card card-container" style="max-width:60%">

            <form >
                <fieldset>
                    <legend></legend>
                    <div class="form-group">
                        <label class="col-md-4 control-label" >Nom<span style="color:red;margin-left:5px;font-weight: 900">*</span></label>
                        <div class="col-md-6  inputGroupContainer">
                            <div class="input-group"> <span class="input-group-addon"><i class="glyphicon glyphicon-bookmark"></i></span>
                                <input value="" name="EditNomAct" placeholder="Exemple : Flappy bird" id="EditNomAct" class="form-control"  type="text">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-4 control-label" >Description<span style="color:red;margin-left:5px;font-weight: 900">*</span></label>
                        <div class="col-md-6  inputGroupContainer">
                            <div class="input-group"> <span class="input-group-addon"><i class="glyphicon glyphicon-text-background"></i></span>
                                <textarea name="EditDescriptionAct" placeholder="faut mettre le principe du jeu içi" id="EditDescriptionAct" class="form-control"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-4 control-label" >Image<span style="color:red;margin-left:5px;font-weight: 900">*</span></label>
                        <div class="col-md-6  inputGroupContainer">
                            <div class="input-group"> <span class="input-group-addon"><i class="glyphicon glyphicon-camera"></i></span>
                                <input type='file' name="EditImageAct" placeholder="Deposer l'image içi" id="EditImageAct" class="form-control"/>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-4 control-label">Activer ?</label>
                        <div class="col-md-6  inputGroupContainer">
                            <div class="rdio rdio-theme circle col-md-3" style="transform: scale(0.9);margin-left: 1%;">
                                <input id="Edit-radio-type-circle1" type="radio"  name="EditactivationAct" value="1" checked>
                                <label for="Edit-radio-type-circle1">Oui</label>
                            </div>
                            <div style="transform: scale(0.9);" class="rdio rdio-theme circle col-md-3">
                                <input id="Edit-radio-type-circle2" type="radio" name="EditactivationAct" value="0">
                                <label for="Edit-radio-type-circle2">Non</label>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-4 control-label" >Date Début<span style="color:red;margin-left:5px;font-weight: 900">*</span></label>
                        <div class="col-md-6  inputGroupContainer">
                            <div class="input-group"> <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
                                <input value="" data-mask="39/19/2999" name="EditDateDebutAct" placeholder="Date début activité" id="EditDateDebutAct" class="form-control datepicker"  type="text">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-4 control-label" >Date Fin<span style="color:red;margin-left:5px;font-weight: 900">*</span></label>
                        <div class="col-md-6  inputGroupContainer">
                            <div class="input-group"> <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
                                <input value="" data-mask="39/19/2999" name="EditDateFinAct" placeholder="Date Fin activité" id="EditDateFinAct" class="form-control datepicker"  type="text">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-4 control-label" >Coins<span style="color:red;margin-left:5px;font-weight: 900">*</span></label>
                        <div class="col-md-6  inputGroupContainer">
                            <div class="input-group"> <span class="input-group-addon"><i class="glyphicon glyphicon-bitcoin"></i></span>
                                <input value="" name="EditNbrPointAct" placeholder="Nombre Point Totale a Gagnée" id="EditNbrPointAct" class="form-control"  type="text">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-4 control-label" >Experience<span style="color:red;margin-left:5px;font-weight: 900">*</span></label>
                        <div class="col-md-6  inputGroupContainer">
                            <div class="input-group"> <span class="input-group-addon"><i class="glyphicon glyphicon-level-up"></i></span>
                                <input value="" name="EditExpAct" placeholder="Experience a Gagnée" id="EditExpAct" class="form-control"  type="text">
                            </div>
                        </div>
                    </div>
                </fieldset>
                <input id="EditActivity" type="button" value="Modifier Activité"/>
            </form>
        </div><!-- /card-container -->
    </div><!-- /container -->
{% endblock %}
{% block javascript %}
    <script>
        var menu = $('#boutique2ndnav');
        var origOffsetY = menu.offset().top;

        function scroll() {
            if ($(window).scrollTop() >= origOffsetY - 50) {
                $('#boutique2ndnav').css({'position': 'fixed', 'width': '100%', 'top': '60px', 'z-index': '1020'});
            } else {
                $('#boutique2ndnav').removeAttr('style');
                $('#boutique2ndnav').css({'padding-top': '25px', 'background-color': '#E0E2E0', 'height': '60px'});

            }


        }
        scroll();
        document.onscroll = scroll;
    </script>
    <script>
        $("#DateFinAct").datepicker({dateFormat: 'dd-mm-yy',
            altField: "#datepicker",
            closeText: 'Fermer',
            prevText: 'Précédent',
            nextText: 'Suivant',
            currentText: 'Aujourd\'hui',
            monthNames: ['Janvier', 'Février', 'Mars', 'Avril', 'Mai', 'Juin', 'Juillet', 'Août', 'Septembre', 'Octobre', 'Novembre', 'Décembre'],
            monthNamesShort: ['Janv.', 'Févr.', 'Mars', 'Avril', 'Mai', 'Juin', 'Juil.', 'Août', 'Sept.', 'Oct.', 'Nov.', 'Déc.'],
            dayNames: ['Dimanche', 'Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi'],
            dayNamesShort: ['Dim.', 'Lun.', 'Mar.', 'Mer.', 'Jeu.', 'Ven.', 'Sam.'],
            dayNamesMin: ['D', 'L', 'M', 'M', 'J', 'V', 'S'],
            weekHeader: 'Sem.'
        });
    </script>
    <script>
        function AjouterActivity() {
            $_data = {
                'idCategorie': "{{categorie.getId()}}",
                'actNom': $("#NomAct").val(),
                'actDescription': $("#DescriptionAct").val(),
                'actActivation': $("input[name='activationAct']:checked").val(),
                'actDatedebut': $("#DateDebutAct").val(),
                'actDatefin': $("#DateFinAct").val(),
                'actNbrpoint': $("#NbrPointAct").val(),
                'actexp': $("#ExpAct").val(),
                'actImage': "img\\game\\1.jpg"
            };
            $.ajax({
                type: "POST",
                url: "{{path('add_activite')}}",
                data: $_data,
                success: function () {
                    location.reload();
                }
            });
        }
        function DeleteActivity($id) {
            $_data = {
                'id': $id
            };
            $.ajax({
                type: "POST",
                url: "{{path('delete_activite')}}",
                data: $_data,
                success: function () {
                    location.reload();
                }
            });
        }
        function ValidationActivity($id) {
            $_data = {
                'id': $id
            };
            $.ajax({
                type: "POST",
                url: "{{path('activation_activite')}}",
                data: $_data,
                success: function () {
                    location.reload();
                }
            });
        }

        function editModalAct($idact) {
        {%for act in activites%}
                if ($idact == {{act.getId()}}) {
                    $("#EditNomAct").val("{{act.getNom()}}");
                    $("#EditDescriptionAct").val("{{act.getDescription()}}");
                    $("#EditDateDebutAct").val("{{act.getdat_deb()|date("d/m/Y")}}");
                    $("#EditDateFinAct").val("{{act.getdat_fin()|date("d/m/Y")}}");
                    $("#EditNbrPointAct").val("{{act.getNbrPoint()}}");
                    $("#EditExpAct").val("{{act.getExperience()}}");
                    $('#editact').find("legend").first().html("Modifier Activité | {{act.getNom()}}");


            {%if act.getActivation() == "0"%}
                        $("#Edit-radio-type-circle1").prop('checked', false);
                        $("#Edit-radio-type-circle2").prop('checked', true);
            {%elseif act.getActivation() == "1"%}
                        $("#Edit-radio-type-circle2").prop('checked', false);
                        $("#Edit-radio-type-circle1").prop('checked', true);
            {%endif%}
                        $("#EditActivity").attr('onclick', "ModifierActivity('{{act.getId()}}')");

                        $('#editact').modal('show');
                    }
        {% endfor %}
            }
            function ModifierActivity($id) {
                $_data = {
                    'id': $id,
                    'actNom': $("#EditNomAct").val(),
                    'actDescription': $("#EditDescriptionAct").val(),
                    'actActivation': $("input[name='EditactivationAct']:checked").val(),
                    'actDatedebut': $("#EditDateDebutAct").val(),
                    'actDatefin': $("#EditDateFinAct").val(),
                    'actNbrpoint': $("#EditNbrPointAct").val(),
                    'actexp': $("#EditExpAct").val(),
                    'actImage': "img\\game\\1.jpg"
                };
                $.ajax({
                    type: "POST",
                    url: "{{path('edit_activite')}}",
                    data: $_data,
                    success: function () {
                        location.reload();
                    }
                });
            }
    </script>
{% endblock %}
